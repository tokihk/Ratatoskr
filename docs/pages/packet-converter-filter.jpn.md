<link href="../params.css" rel="stylesheet" />

# Packet Converter - Filter

条件に一致するパケットのみを通過させます。<br>

パターンは `(...)` による優先度指定や条件演算子`&&` `||`により条件を組み合わせることができます。<br>

| 条件演算子 | 動作 |
| :---       | :--- |
| `A && B`   | AとBの両方の条件を満たしたときに条件を満たします。        |
| `A || B`   | AとBのどちらか一方の条件を満たしたときに条件を満たします。|

パケット要素は以下の変数にて参照できます。(表記通り or 全て小文字 で指定できます)
| 変数名          | 内容 | データ型 |
| :---            | :--- | :---     |
| `PacketCount`   | その変換機に到達したパケット数を返します。                     | Number         |
| `LastDelta`     | 直前に到達したパケットとの差分時間を返します。                 | DateTimeOffset |
| `IsControl`     | そのパケットがコントロールパケットかどうかを返します。(未使用) | Bool           |
| `IsMessage`     | そのパケットがメッセージパケットかどうかを返します。           | Bool           |
| `IsData`        | そのパケットがデータパケットかどうかを返します。               | Bool           |
| `Alias`         | そのパケットを作成したゲートのAliasを返します。                | Text           |
| `DateTime`      | そのパケットが発生した時間を返します。                         | DateTime       |
| `Class`         | そのパケットのクラス情報を返します。                           | Text           |
| `Information`   | そのパケットの付加情報を返します。                             | Text           |
| `Mark`          | そのパケットのマーク値を返します。(未使用)                     | Number         |
| `IsSend`        | 送信パケットかどうかを返します。                               | Bool           |
| `IsRecv`        | 受信パケットかどうかを返します。                               | Bool           |
| `Source`        | パケットの送信元情報を返します。                               | Text           |
| `Destination`   | パケットの送信先情報を返します。                               | Text           |
| `DataSize`      | そのパケットのデータサイズを返します。                         | Text           |
| `BitString`     | データ部分を2進数表記で返します。                              | Text           |
| `HexString`     | データ部分を16進数表記で返します。                             | Text           |
| `AsciiText`     | データ部分をASCII表記で返します。                              | Text           |
| `Utf8Text`      | データ部分をUTF-8表記で返します。                              | Text           |
| `Utf16LeText`   | データ部分をUTF-16LE表記で返します。                           | Text           |
| `Utf16BeText`   | データ部分をUTF-16BE表記で返します。                           | Text           |
| `ShiftJisText`  | データ部分をShift_JIS表記で返します。                          | Text           |
| `EucJpText`     | データ部分をEuc-Jp表記で返します。                             | Text           |

パラメータ要素は以下の記述で定義できます。
| 型 | 正規表現 | 記述例 |
| :--- | :--- | :--- |
| Number   | `[0]|([1-9][0-9]{0,8})(\.[0-9]{1,8}){0,1}` | `0`<br>`12345`<br>`12345.0123` |
| Number   | `0[xX][0-9a-fA-F]{1,8}`                    | `0x01234567` |
| DateTime | `[$]{TY}-{TM}-{TD}T{Th}:{Tm}:{Ts}(\.{Tf})?([\+\-]{Th}:{Tm}|Z)[$]`<br>`[$]{TY}(-{TM}(-{TD}([ ]{Th}(:{Tm}(:{Ts}(\.{Tf})?)?)?)?)?)?[$]`<br>`[$]((({TY}-)?{TM}-)?{TD}[ ])?{Th}:{Tm}:{Ts}(\.{Tf})?[$]` | ISO8601形式<br>`2018-01-01 01:00:00.000`<br>`01:00:00.000` |
| DateTimeOffset | `{Th}:{Tm}:{Ts}\.{Tf}`                    | `00:00:15.123` |
| DateTimeOffset | `([0]|([1-9][0-9]{0,9}))(h|hour|m|min|s|sec|ms|msec)` | `100h`<br>`100m`<br>`100s`<br>`100ms` |
| Text | `\"[^\"]*\"` | `"abcdef"` |
| Regex(正規表現) | `\/[^/]*\/` | `/02.*03/` |
- **Regex型はText型と正規表現で比較できます。**
- 省略記号は以下を表します。
  - `TY = ([0-9]{4})`
  - `TM = ([0][0-9]|1[0-2])`
  - `TD = ([0-2][0-9]|3[0-1])`
  - `Th = ([0-1][0-9]|2[0-3])`
  - `Tm = ([0-5][0-9])`
  - `Ts = ([0-5][0-9])`
  - `Tf = ([0-9]{3})`

よく使う記述例を以下に提示します。
| フィルタ式 | 意味 |
| :--- | :--- |
| `IsData && HexText == /02.*03/` | 02～03で囲まれているデータパケット |

<br><br>
